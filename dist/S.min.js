!function(n){var t={};n(function(n,e,r){if(t.hasOwnProperty(n))throw new Error("define: cannot redefine module "+n);t[n]=r.apply(null,e.map(function(e){if(!t.hasOwnProperty(e))throw new Error("define: module "+e+" required by "+n+" has not been defined.");return t[e]}))}),"object"==typeof module&&"object"==typeof module.exports?module.exports=t.S:"function"==typeof define?define([],function(){return t.S}):this.S=t.S}(function(n){"use strict";n("S",[],function(){function n(t,e){return n.lift(t,e)}function t(t,o){return"function"==typeof t?r(t,o):t instanceof Array?n.seq(t):e(t)}function e(n){function t(t){if(arguments.length>0){if(void 0===t)throw new Error("S.data can't be set to undefined.  In S, undefined is reserved for namespace lookup failures.");n=t,c(r),s()}else y.length&&y[y.length-1].listener(e,o,r);return n}if(void 0===n)throw new Error("S.data can't be initialized with undefined.  In S, undefined is reserved for namespace lookup failures.");var e=v++,r=[],o=y;return t.S=new i,t.toString=l,t}function r(n){function t(){return y.length&&y[y.length-1].listener(d,E,k),a}function e(){var t,e,r;if(!g){for(g=!0,r=y,y=E,t=0;t<O.children.length;t++)O.children[t]();O.children=[],p++;try{e=n(),void 0!==e&&(a=e,c(k))}finally{g=!1,y=r}o(p,S,m,b)}}function r(n,t,e){var r,o,u;for(r=0,o=w.length;o>r;r++)if(n===w[r])return u=m[r],null===e[u]&&(e[u]=b[r],b[r]=e),void(S[r]=p);for(u=e.length,w.push(n),S.push(p),m.push(u),b.push(e),r=0,o=Math.min(E.length,t.length);o>r&&E[r]===t[r];r++);e.push(h[r])}function i(){var n,t;for(n=0,t=m.length;t>n;n++)b[n][m[n]]=void 0,b[n]=void 0;for(n=0;n<O.children.length;n++)O.children[n]()}function l(){return"[formula: "+n+"]"}var a,h,d=v++,p=1,g=!1,w=[],S=[],m=[],b=[],k=[],O={listener:r,mod:this&&this.fn||null,children:[]},E=y.slice(0);return y.length&&y[y.length-1].children.push(i),E.push(O),h=u(E,e,d),t.S=new f(i),t.toString=l,e(),s(),t}function o(n,t,e,r){var o,u,i,f,c;for(o=0,u=t.length;u>o;o++)i=t[o],0!==i&&n>i&&(f=r[o],c=e[o],r[o]=f[c],f[c]=null,t[o]=0)}function u(n,t,e){var r,o,u=[];for(r=n.length-1;r>=0;r--)o=n[r],o.mod&&(t=o.mod(t,e)),u[r]=t;return u}function i(){}function f(n){this.detach=n}function c(n){var t,e,r;for(t=0,e=n.length;e>t;t++)r=n[t],r&&r()}function l(){return"[data: "+n.peek(this)+"]"}function a(n){var t,e,r;if(y.length){t=y[y.length-1],e=t.listener,t.listener=function(){};try{r=n()}finally{t.listener=e}}else r=n();return r}function h(n){y.length?g.push(n):n()}function s(){if(!y.length)for(;0!==g.length;)g.shift()()}function d(){}function p(){}var v=1,y=[],g=[];return n.lift=t,n.data=e,n.formula=r,n.peek=a,n.defer=h,n.cleanup=d,n.finalize=p,n.data.S=i,f.prototype=new i,n.formula.S=f,n}),n("Chainable",[],function(){function n(n,t){return function(e){return n(t(e))}}return function(t,e,r){this.head=void 0!==r?r:e&&void 0!==e.head?e.head:null,this.fn=e&&void 0!==e.fn?n(t,e.fn):t}}),n("S.sub",["S"],function(n){n.sub=function t(){var e=Array.prototype.slice.call(arguments),r=function(){},o=e.pop(),u=e.length,i=new Array(u),t=this.S(function(){for(var t=0;u>t;t++)i[t]=e[t]();return n.peek(function(){return r.apply(void 0,i)})});return r=o,t}}),n("S.mods",["S","Chainable"],function(n,t){function e(n,e){t.call(this,n,e)}function r(){return new e(g(arguments.slice(0)),this)}function o(){return new e(g([]),this)}function u(){return new e(h(),this)}function i(n){return new e(s(n),this)}function f(n){return new e(p(n),this)}function c(n){return new e(d(n),this)}function l(n){return new e(v(n),this)}function a(n){return new e(y(n),this)}function h(n){return void 0!==n?w(n):function(n){var t=!1;return function(){t||(t=!0,w(function(){t=!1,n()}))}}}function s(n){return function(t){return function(){setTimeout(t,n)}}}function d(n){return function(t){var e=0,r=!1;return function(){if(!r){var o=Date.now();o-e>n?(e=o,t()):(r=!0,setTimeout(function(){e=Date.now(),r=!1,t()},n-(o-e)))}}}}function p(n){return function(t){var e=0,r=0;return function(){var o=Date.now();o>e&&(e=o,r&&clearTimeout(r),r=setTimeout(t,n))}}}function v(t){var e=[];return n.formula(function(){if(t()){for(var n=0;n<e.length;n++)e[n]();e=[]}}),function(n){return function(){e.push(n)}}}function y(t){var e=[];return n.formula(function(){if(t()){for(var n=0;n<e.length;n++)e[n]();e=[]}}),function(n){var t=!1;return function(){t||(t=!0,e.push(function(){t=!1,n()}))}}}function g(){return function(n){return n}}var w=n.defer;e.prototype=new t,e.prototype.S=n.formula,e.prototype.sub=n.sub,n.on=e.prototype.on=r,n.once=e.prototype.once=o,n.defer=e.prototype.defer=u,n.delay=e.prototype.delay=i,n.debounce=e.prototype.debounce=f,n.throttle=e.prototype.throttle=c,n.pause=e.prototype.pause=l,n.throttledPause=e.prototype.throttledPause=a}),n("S.toJSON",["S"],function(n){n.toJSON=function(n){return JSON.stringify(n,function(n,t){return"function"==typeof t&&t.S?t():t})}})});