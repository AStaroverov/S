!function(){"use strict";function n(n){function t(){return S?(a(S),0!==S.marks&&c(S,b),S.payload.value):void 0}function u(){if(S){var n,t;if(p(z),S){for(n=-1,t=z.finalizers.length;++n<t;)if(z.finalizers[n](),!S)return;for(z.fn=null,z.value=null,z.finalizers=null,z=null,n=-1,t=S.inbound.length;++n<t;)m(S.inbound[n]);S.payload=null,S.inbound=null,S.inboundIndex=null,S.outbound=null,S=null}}}var s,f,h,g;arguments.length>1&&(s=n,f=Array.prototype.slice.call(arguments,1),n=function(){return s.apply(null,f)});var y=this instanceof o?this.options:new i,w=b,k=y.region||w&&w.region||null,z=new l(n),S=new e(++v,z,k);if(b=S,y.sources){for(h=-1,g=y.sources.length;++h<g;)y.sources[h]();z.listening=!1}if(w&&(w.payload.pinning||y.pin?w.payload.finalizers.push(u):w.payload.cleanups.push(u)),!y.init||y.init(S)){S.trigger=w||S;try{S.payload.value=n()}catch(x){throw d(S),x}finally{S.trigger=null,b=w}}else b=w;return t.dispose=u,t.toJSON=r,t}function t(n){var t;if(w)w(n);else{s(n),t=b,b=null;try{f(n,t||n)}catch(i){throw d(n),i}finally{b=t}}}function i(){this.sources=null,this.pin=!1,this.init=null,this.region=null}function o(){this.options=new i}function r(){return this()}function e(n,t,i){this.id=n,this.payload=t,this.region=i,this.marks=0,this.trigger=null,this.cur=0,this.inbound=[],this.inboundIndex=[],this.outbound=[]}function u(n,t,i){this.from=n,this.to=t,this.boundary=i,this.active=!0,this.marked=!1,this.gen=t.payload.gen,this.outboundOffset=n.outbound.length,n.outbound.push(this),t.inbound.push(this),t.inboundIndex[n.id]=this}function l(n){this.fn=n,this.gen=1,this.value=void 0,this.listening=!0,this.pinning=!1,this.cleanups=[],this.finalizers=[]}function a(n){var t=b,i=null;t&&t.payload.listening&&(i=t.inboundIndex[n.id],i?y(i,n):new u(n,t,t.region&&n.region!==t.region))}function s(n){n.trigger=n;for(var t,i,o=-1,r=n.outbound.length;++o<r;)if(t=n.outbound[o],t&&!t.marked&&(!t.boundary||t.to.region(t.to))){if(i=t.to,i.trigger)throw new Error("circular dependency");t.marked=!0,i.marks++,1===i.marks&&s(i)}n.trigger=null}function f(n,t){var i,o,r,e,u;if(n.trigger=t,n.payload&&(u=n.payload,b=n,p(u),u.gen++,u.value=u.fn(),u.listening&&n.inbound))for(i=-1,o=n.inbound.length;++i<o;)r=n.inbound[i],r.active&&r.gen<u.gen&&m(r);for(n.cur=-1,o=n.outbound?n.outbound.length:0;++n.cur<o;)r=n.outbound[n.cur],r&&r.marked&&(e=r.to,r.marked=!1,e.marks--,0===e.marks&&f(e,n));n.trigger=null}function c(n,t){for(var i,o=-1,r=n.inbound.length;++o<r;)i=n.inbound[o],i&&i.marked&&(i.from.marked?c(i.from,t):h(i.from,t))}function h(n,t){var i=b;try{f(n,t)}catch(o){throw d(n),o}finally{b=i}}function d(n){n.marks=0,n.trigger=null,n.cur=0;for(var t,i=-1,o=n.outbound.length;++i<o;)t=n.outbound[i],t&&t.marked&&(t.marked=!1,d(t.to))}function g(n){for(var t,i,o;n!==n.trigger&&(n=n.trigger);)for(t=n.outbound.length;++n.cur<t;)i=n.outbound[n.cur],i&&i.marked&&(o=i.to,i.marked=!1,o.marks--,0===o.marks&&f(o,n))}function p(n){for(var t=-1;n.cleanups&&++t<n.cleanups.length;)n.cleanups[t]();n.cleanups=[]}function y(n,t){n.active||(n.active=!0,t.outbound[n.outboundOffset]=n,n.from=t),n.gen=n.to.payload.gen}function m(n){n.active=!1,n.from.outbound&&(n.from.outbound[n.outboundOffset]=null),n.from=null}"object"==typeof module&&"object"==typeof module.exports?module.exports=n:"function"==typeof define?define([],function(){return n}):(eval||!1)("this").S=n;var v=0,b=null,w=null;n.data=function z(n){function z(o){return arguments.length>0?(b&&g(b),n=o,t(i)):a(i),n}var i=new e(++v,null,b?b.region:null);return z.toJSON=r,z},o.prototype={on:function(){return this.options.sources=Array.prototype.slice.apply(arguments),this},once:function(){return this.options.sources=[],this},pin:function(){return this.options.pin=!0,this},defer:function(){return this},throttle:function(t){var i=n.region(),o=0;return this.options.region=function(n){var r=Date.now();i(n),r-o>t?(o=r,i.go()):setTimeout(function(){o=Date.now(),i.go()},t-(r-o))},this},debounce:function(t){var i=n.region(),o=0,r=0;return this.options.region=function(n){var e=Date.now();i(n),e>o&&(o=e,r&&clearTimeout(r),r=setTimeout(i.go,t))},this},pause:function(n){return this.options.region=n,this},when:function(){var n=Array.prototype.slice.apply(arguments),t=n.length;return this.options.sources=n,this.options.region=this.options.init=function(){for(var i=-1;++i<t;)if(void 0===n[i]())return!1;return!0},this}};for(var k in o.prototype)n[k]=function(n){return function(){var t=new o;return t[n].apply(t,arguments)}}(k);o.prototype.S=n,n.region=function S(){function S(n){i[n.id]||(t.push(n),i[n.id]=n)}function n(){var n,o;for(n=-1;++n<t.length;)s(t[n]);o=b,b=null,n=-1;try{for(;++n<t.length;)f(t[n],t[n])}catch(r){for(n--;++n<t.length;)d(t[n]);throw r}finally{b=o}t=[],i={}}var t=[],i={};return S.go=n,S},n.peek=function(n){if(!b||!b.payload.listening)return n();b.payload.listening=!1;try{return n()}finally{b.payload.listening=!0}},n.pin=function(n){if(0===arguments.length)return(new o).pin();if(!b||b.payload.pinning)return n();b.payload.pinning=!0;try{return n()}finally{b.payload.pinning=!1}},n.cleanup=function(n){if(!b)throw new Error("S.cleanup() must be called from within an S.formula.  Cannot call it at toplevel.");b.payload.cleanups.push(n)},n.finalize=function(n){if(!b)throw new Error("S.finalize() must be called from within an S.formula.  Cannot call it at toplevel.");b.payload.finalizers.push(n)},n.freeze=function x(t){if(w)t();else{var x=w=n.region();try{t()}finally{w=null}x.go()}}}();