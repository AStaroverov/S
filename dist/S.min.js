!function(n){"use strict";var t=function(){function n(t,e){return n.lift(t,e)}function t(t,o){return"function"==typeof t?r(t,o):t instanceof Array?n.seq(t):e(t)}function e(n){function t(t){if(arguments.length>0){if(void 0===t)throw new Error("S.data can't be set to undefined.  In S, undefined is reserved for namespace lookup failures.");n=t,c(r),s()}else p.length&&p[p.length-1].listener(e,o,r);return n}if(void 0===n)throw new Error("S.data can't be initialized with undefined.  In S, undefined is reserved for namespace lookup failures.");var e=d++,r=[],o=p;return t.S=new i,t.toString=a,t}function r(n){function t(){return p.length&&p[p.length-1].listener(v,A,k),l}function e(){var t,e,r;if(!y){for(y=!0,r=p,p=A,t=0;t<T.children.length;t++)T.children[t]();T.children=[],g++;try{e=n(),void 0!==e&&(l=e,c(k))}finally{y=!1,p=r}o(g,m,S,b)}}function r(n,t,e){var r,o,u;for(r=0,o=w.length;o>r;r++)if(n===w[r])return u=S[r],null===e[u]&&(e[u]=b[r],b[r]=e),void(m[r]=g);for(u=e.length,w.push(n),m.push(g),S.push(u),b.push(e),r=0,o=Math.min(A.length,t.length);o>r&&A[r]===t[r];r++);e.push(h[r])}function i(){var n,t;for(n=0,t=S.length;t>n;n++)b[n][S[n]]=void 0,b[n]=void 0;for(n=0;n<T.children.length;n++)T.children[n]()}function a(){return"[formula: "+n+"]"}var l,h,v=d++,g=1,y=!1,w=[],m=[],S=[],b=[],k=[],T={listener:r,mod:this&&this.fn||null,children:[]},A=p.slice(0);return p.length&&p[p.length-1].children.push(i),A.push(T),h=u(A,e,v),t.S=new f(i),t.toString=a,h[h.length-1](),s(),t}function o(n,t,e,r){var o,u,i,f,c;for(o=0,u=t.length;u>o;o++)i=t[o],0!==i&&n>i&&(f=r[o],c=e[o],r[o]=f[c],f[c]=null,t[o]=0)}function u(n,t,e){var r,o,u=[];for(r=n.length-1;r>=0;r--)o=n[r],o.mod&&(t=o.mod(t,e)),u[r]=t;return u}function i(){}function f(n){this.detach=n}function c(n){var t,e,r;for(t=0,e=n.length;e>t;t++)r=n[t],r&&r()}function a(){return"[data: "+n.peek(this)+"]"}function l(n){var t,e;if(p.length){t=p,p=[];try{e=n()}finally{p=t}}else e=n();return e}function h(n){p.length?v.push(n):n()}function s(){if(!p.length)for(;0!==v.length;)v.shift()()}var d=1,p=[],v=[];return n.lift=t,n.data=e,n.formula=r,n.peek=l,n.defer=h,n.data.S=i,f.prototype=new i,n.formula.S=f,n}();n.S=t,function(n){function t(n,t,r){this.head=void 0!==r?r:t&&void 0!==t.head?t.head:null,this.fn=t&&void 0!==t.fn?e(t.fn,n):n}function e(n,t){return function(e){return n(t(e))}}n.Chainable=t}(t),function(n){function t(t,e){n.Chainable.call(this,t,e)}function e(){return new t(c(),this)}function r(n){return new t(a(n),this)}function o(n){return new t(h(n),this)}function u(n){return new t(l(n),this)}function i(n){return new t(s(n),this)}function f(n){return new t(d(n),this)}function c(n){return void 0!==n?p(n):function(n){var t=!1;return function(){t||(t=!0,p(function(){t=!1,n()}))}}}function a(n){return function(t){return function(){setTimeout(t,n)}}}function l(n){return function(t){var e=0,r=!1;return function(){if(!r){var o=Date.now();o-e>=n?(e=o,t()):(r=!0,setTimeout(function(){e=Date.now(),r=!1,t()},n-(o-e)))}}}}function h(n){return function(t){var e=0;return function(){e&&clearTimeout(e),e=setTimeout(t,n)}}}function s(t){var e=[];return n.formula(function(){if(t()){for(var n=0;n<e.length;n++)e[n]();e=[]}}),function(n){return function(){e.push(n)}}}function d(t){var e=[];return n.formula(function(){if(t()){for(var n=0;n<e.length;n++)e[n]();e=[]}}),function(n){var t=!1;return function(){t||(t=!0,e.push(function(){t=!1,n()}))}}}var p=n.defer;t.prototype=new n.Chainable,t.prototype.S=n.formula,n.defer=t.prototype.defer=e,n.delay=t.prototype.delay=r,n.debounce=t.prototype.debounce=o,n.throttle=t.prototype.throttle=u,n.pause=t.prototype.pause=i,n.throttledPause=t.prototype.throttledPause=f}(t),function(n){function t(t){var e;return n.proc(function(){var r;return e&&e.S.detach(),e=n.region(function(){r=t()}),r})}n.rproc=t}(t),function(n){function t(){var t=Array.prototype.slice.call(arguments),e=function(){},r=t.pop(),o=t.length,u=new Array(o),i=n(function(){for(var r=0;o>r;r++)u[r]=t[r]();return n.peek(function(){return e.apply(void 0,u)})});return e=r,i}n.sub=t}(t),function(n){n.toJSON=function(n){return JSON.stringify(n,function(n,t){return"function"==typeof t&&t.S?t():t})}}(t)}(window);