<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>K.DOM scratch examples</title>
    <script type="text/javascript" src="../js/K.js"></script>
    <script type="text/javascript" src="../js/K.rproc.js"></script>
    <script type="text/javascript" src="../js/K.seq.spec.js"></script>
    <script type="text/javascript" src="../js/K.DOM.js"></script>
    <script type="text/javascript" src="../js/K.DOM.src.js"></script>
</head>
<body>
    <form id="form" method="get" action="html-bindings.html">
        <input id="text" name="text" type="text" value="text" />
        <input id="radio" name="radio" type="radio" value="radio" />
        <input id="radio2" name="radio" type="radio" value="radio2" />
        <input id="checkbox" name="checkbox" type="checkbox" value="checkbox" />
        <textarea id="textarea" name="textarea">textarea</textarea>
        <select id="select" name="select">
            <option>one</option>
            <option>two</option>
        </select>
        <select id="multiselect" name="multiselect" multiple>
            <option>one</option>
            <option>two</option>
            <option>three</option>
            <option>four</option>
            <option>five</option>
        </select>
        <input id="button" type="submit" name="submit" value="Submit" />
    </form>

    <ul>
        <!-- {{each item}} -->
            <li class="item {{classes}}">
                <input name="{{name}}" />
                <button type="button" onclick="{{remove}}"><i class="icon-remove-circle"></i></button>
            </li>
        <!-- {{/each}} -->
    </ul>

    <script id="foo" type="text/html">
        function view(items) { return (
            <ul>
                @items().map(function (item) { return (
                    <li class="item" @class:foo = item.selected()>
                        <input type="text" @signal:keydown = item.name/>
                        <button type="button" onclick = item.remove()><i class="icon-remove-circle"></i></button>
                        @item.costs()
                    </li>
                )})
            </ul>
        )}
    </script>

    <script type="text/foo">

    var view = eval(K.DOM.src(
    'function (items) {\n' +
    '   return\n' +
    '       <ul>\n' +
    '           @items.map((item) =>\n' +
    '                <li class="item @item.classes">\n' +
    '                   <input value="@item.name" />\n' +
    '                   <button type="button" onclick="@item.remove"><i class="icon-remove-circle"></i></button>\n' +
    '                   @item.costs\n' +
    '               </li>\n' +
    '           )\n' +
    '       </ul>;\n' +
    '}'
    ));

    var view = eval(K.DOM.src('\
        function (items) {     \
           return              \
               <ul>            \
                   @items.map((item) => \
                        <li class="item @item.classes"> \
                           <input value="@item.name" /> \
                           <button type="button" onclick="@item.remove"><i class="icon-remove-circle"></i></button> \
                           @item.costs \
                       </li>  \
                   )          \
               </ul>;         \
        }                     \
    '));

    var view = eval(K.DOM.src(
    '(items) =>\n' +
    '   <ul>\n' +
    '       @items.map((item) =>\n' +
    '            <li class="item @item.classes">\n' +
    '               <input value="@item.name" />\n' +
    '               <button type="button" onclick="@item.remove"><i class="icon-remove-circle"></i></button>\n' +
    '               @item.costs\n' +
    '           </li>\n' +
    '       )\n' +
    '   </ul>' +
    ));

    function view(items) { return (
        <ul>
            @items.map((item) =>
                <li class="item @item.classes">
                    <input value="@item.name" />
                    <button type="button" onclick="@item.remove"><i class="icon-remove-circle"></i></button>
                    @item.costs
                </li>
            )
        </ul>;
    )}

    var view = (items) =>
       <ul>
           @items.map((item) =>
                <li class="item @item.classes">
                   <input value="@item.name" />
                   <button type="button" onclick="@item.remove"><i class="icon-remove-circle"></i></button>
                   @item.costs
               </li>
           )
       </ul>;

    function view(items) { return @items.map(item => <p>@item</p>); }

    function view(items) { return (new K.DOM.Shell(K.DOM.parse.cache(44664,
                                  '<!-- insert -->'))
                                  .insert(function (__) { __(
                                  items.map(item => (new K.DOM.Shell(K.DOM.parse(44665,
                                                     '<p><!-- insert --></p>'))
                                                     .childNodes([0], function (__) {
                                                          __[0].insert(function (__) { __(item); });
                                                     })
                                                     .node))); })
                                  .node); }

    function view(items) { return (new K.DOM.Shell(K.DOM.parse('<!-- insert -->'))
                                  .insert(function (__) { __(items.map(item => (new K.DOM.Shell(K.DOM.parse('<p><!-- insert --></p>'))
                                                                               .childNodes([0], function (__) {
                                                                                   __[0].insert(function (__) { __(item); });
                                                                               })
                                                                               .node))); })
                                  .node); }

    function view(items) { return items.map(function (item) { return (new K.DOM.Shell(K.DOM.parse('<p><!-- insert --></p>'))
                                                                     .childNodes([0], function (__) {
                                                                         __[0].insert(function (__) { __(item); });
                                                                     })
                                                                     .node); }); }

    function view(items) { return (
        <ul>
            @items().map(function (item) { return (
                <li class="item" @class:foo = item.selected()>
                    <input type="text" @value = item.name/>
                    <button type="button" @on:click = item.remove><i class="icon-remove-circle"></i></button>
                    @item.costs
                </li>
            )})
        </ul>
    )}

    function view(items) { return (
        <ul>
            {items().map(function (item) { return (
                <li class="item" class:foo = {item.selected()}>
                    <input type="text" value = {item.name}/>
                    <button type="button" on:click = {item.remove}><i class="icon-remove-circle"></i></button>
                    {item.costs}
                </li>
            )})}
        </ul>
    )}

    function view(items) { return (
        <ul>
            @items().map(function (item) { return (
                <li class="item" .class('foo', item.selected())>
                    <input type="text" .value(item.name)/>
                    <button type="button" onclick = item.remove><i class="icon-remove-circle"></i></button>
                    @item.costs
                </li>
            )})
        </ul>
    )}

    function view(items) { return (
        <ul>
            @items().map(function (item) { return (
                <li class="item" class:foo = item.selected()>
                    <input type="text" value = item.name/>
                    <button type="button" on:click = item.remove><i class="icon-remove-circle"></i></button>
                    @item.costs
                </li>
            )})
        </ul>
    )}

    function view(items) { return (
        (new K.DOM.Shell(K.DOM.parse.cache(33423434,
        '<ul>\n\
            <!-- insert -->\n\
        </ul>'))
        .childNodes([1], function (__) {
            __[0].insert(function (__) { __(
            items().map(function (item) { return (
                (new K.DOM.Shell(K.DOM.parse.cache(33423435,
                '<li class="item" >\n\
                    <input type="text" />\n\
                    <button type="button" ><i class="icon-remove-circle"></i></button>\n\
                    <!-- insert -->\n\
                </li>'))
                .class(function (__) { __('foo', item.selected()); })
                .childNodes([1, 3, 5], function (__) {
                    __[0].value(function (__) { __(item.name); });
                    __[1].on(function (__) { __('click', item.remove); });
                    __[2].insert(function (__) { __(
                    item.costs); });
                })
                .node)
            )})); });
        })
        .node)
    )}

        function ToDosView(app) { return (
            <ul class="todos">
                <li>
                    <input type="text"
                           placeholder="What needs to be done?"
                           @value:keydown=app.create.title
                           @on:keydown=app.create.keydown />
                </li>
                @app.filteredTodos().map(function (todo) { return (
                    <li class="todo"
                        @class:selected:unselected=todo.selected()
                        @class:completed:incomplete=todo.completed()
                        @on:dblclick=todo.select >
                        <input @checked=todo.completed type="checkbox" />
                        <label>@todo.title()</label>
                        <a @on:click=todo.remove >&times;</a>
                        <input type="text"
                               @hidden=!todo.selected()
                               @focus=todo.selected()
                               @on:blur=todo.deselect
                               @on:keydown=todo.keydown
                               @value:keydown=todo.title />
                    </li>
                )})
            </ul>
            <p>
                @(app.incompleteCount() > 1   ? app.incompleteCount() + " items" :
                  app.incompleteCount() === 1 ? "1 item" :
                  'no items') left
            </p>
            <p>
                  <a @on:click=_.partial(app.filter, null)>All</a>
                | <a @on:click=_.partial(app.filter, false)>Active</a>
                | <a @on:click=_.partial(app.filter, true)>Completed</a>
            </p>
            <p>
                <a @on:click=app.completeAll>Complete All</a>
            </p>
        )}

        function ToDosView(app) { return (
            <ul class="todos">
                <li>
                    <input type = "text"
                           placeholder = "What needs to be done?"
                           value:keydown = app.create.title
                           onkeydown = app.create.keydown />
                </li>
                @app.filteredTodos().map(function (todo) { return (
                    <li class = "todo"
                        class:selected = todo.selected()
                        class:unselected = !todo.selected()
                        class:completed = todo.completed()
                        class:incomplete = todo.completed()
                        ondblclick = todo.select() >
                        <input type = "checkbox" bind(todo.completed) />
                        <label>@todo.title()</label>
                        <a onclick = todo.remove >&times;</a>
                        <input type="text"
                               hidden = !todo.selected()
                               onblur = todo.deselect
                               onkeydown = todo.keydown
                               focus(todo.selected())
                               bind(todo.title, 'keydown') />
                    </li>
                )})
            </ul>
            <p>
                @(app.incompleteCount() > 1   ? app.incompleteCount() + " items" :
                  app.incompleteCount() === 1 ? "1 item" :
                  'no items') left
            </p>
            <p>
                  <a onclick = _.partial(app.filter, null)>All</a>
                | <a onclick = _.partial(app.filter, false)>Active</a>
                | <a onclick = _.partial(app.filter, true)>Completed</a>
            </p>
            <p>
                <a onclick = app.completeAll>Complete All</a>
            </p>
        )}

        function ToDosView(app) { return (
            <ul class="todos">
                <li>
                    <input type="text"
                           placeholder="What needs to be done?"
                           value.keydown={app.create.title}
                           on.keydown={app.create.keydown} />
                </li>
                @app.filteredTodos().map(function (todo) { return (
                    <li class="todo"
                        class:selected:unselected={todo.selected()}
                        class:completed:incomplete={todo.completed()}
                        on:dblclick={todo.select} >
                        <input checked={todo.completed} type="checkbox" />
                        <label>{todo.title()}</label>
                        <a on:click={todo.remove} >&times;</a>
                        <input type="text"
                               hidden={!todo.selected()}
                               focus={todo.selected()}
                               on:blur={todo.deselect}
                               on:keydown={todo.keydown}
                               value:keydown={todo.title} />
                    </li>
                )})
            </ul>
            <p>
                {app.incompleteCount() > 1   ? app.incompleteCount() + " items" :
                 app.incompleteCount() === 1 ? "1 item" :
                 'no items'} left
            </p>
            <p>
                  <a on:click={_.partial(app.filter, null)}>All</a>
                | <a on:click={_.partial(app.filter, false)}>Active</a>
                | <a on:click={_.partial(app.filter, true)}>Completed</a>
            </p>
            <p>
                <a on:click={app.completeAll}>Complete All</a>
            </p>
        )}

        function ToDosView(app) { return (
            <ul class="todos">
                <li>
                    <input type = "text"
                           placeholder = "What needs to be done?"
                           @onkeydown:enter = app.create.add()
                           @onkeydown:escape = app.create.title('')
                           @bind:keydown = app.create.title />
                </li>
                @app.filteredTodos().map(function (todo) { return (
                    <li class = "todo"
                        ondblclick = todo.startEditing()
                        @class:editing = todo.editing()
                        @class:completed = todo.completed() >
                        <input type="checkbox" @bind = todo.completed />
                        <label>@todo.title()</label>
                        <a onclick=todo.remove() >&times;</a>
                        <input type = "text"
                               hidden = !todo.editing()
                               onblur = todo.stopEditing(true)
                               @onkeydown:enter = todo.stopEditing(true)
                               @onkeydown:escape = todo.stopEditing(false)
                               @focus = todo.selected()
                               @bind:keydown = todo.title />
                    </li>
                )})
            </ul>
            <p>
                @(app.incompleteCount() > 1   ? app.incompleteCount() + " items" :
                  app.incompleteCount() === 1 ? "1 item" :
                  'no items') left
            </p>
            <p>
                  <a @class:selected = (app.filter() === null)  onclick = app.filter(null) >All</a>
                | <a @class('selected', app.filter() === false) onclick = app.filter(false)>Active</a>
                | <a @class('selected', app.filter() === true)  onclick = app.filter(true) >Completed</a>
            </p>
            <p>
                <a onclick = app.completeAll() >Complete All</a>
            </p>
        )}

        function ToDosView(app) { return (
            <section id="todoapp">
                <header id="header">
                    <h1>todos</h1>
                    <input id="new-todo"
                           placeholder="What needs to be done?"
                           autofocus
                           @key:enter=app.create.add()
                           @key:escape=(app.create.title(''), __.blur())
                           @signal:keydown=app.create.title />
                </header>
                <section id="main" hidden=(app.all().length === 0)>
                    <input id="toggle-all" type="checkbox" onchecked=app.completeAll() />
                    <label for="toggle-all">Mark all as complete</label>
                    <ul id="todo-list">
                        @app.filtered().map(function (todo) { return (
                            <li @class:completed=todo.completed()
                                @class:editing=todo.selected() >
                                <div class="view">
                                    <input class="toggle" type="checkbox" @signal=todo.completed />
                                    <label ondblclick=todo.select()>@todo.title()</label>
                                    <button class="destroy" onclick=todo.remove()></button>
                                </div>
                                <input class="edit"
                                       onblur=todo.stopEditing(true)
                                       @focus=todo.editing()
                                       @key:enter=todo.stopEditing(true)
                                       @key:escape=todo.stopEditing(false)
                                       @signal:keydown=todo.title />
                            </li>
                        )})
                    </ul>
                </section>
                <footer id="footer" hidden = !app.all().length >
                    <span id="todo-count">
                        <strong>@app.remaining().length</strong>
                        @(app.remaining().length === 1 ? "item" : "items")
                        left
                    </span>
                    <ul id="filters">
                        <li>
                            <a @class:selected = (app.filter() === null) onclick = app.filter(null)>All</a>
                        </li>
                        <li>
                            <a @class:selected = (app.filter() === false) onclick = app.filter(false)>Active</a>
                        </li>
                        <li>
                            <a @class:selected = (app.filter() === true) onclick = app.filter(true)>Completed</a>
                        </li>
                    </ul>
                    <button id="clear-completed" hidden = (app.completed().length === 0) onclick = app.clearCompleted() >
                        Clear completed (@app.completed().length)
                    </button>
                </footer>
            </section>
            <footer id="info">
                <p>Double-click to edit a todo</p>
                <p>Written by <a href="https://github.com/curveship">Adam Haile</a></p>
                <p>Inspired by <a href="http://todomvc.com">TodoMVC</a></p>
            </footer>
        )}

    "use strict";
    var __tmpl_ul_34 = K.DOM.template(
            '\n' +
            '        <ul>\n' +
            '        </ul>\n' +
            '    ',
            [{ path: [1, 0], splits: ['\n        ', '\n        '] }],
            [{ path: [1, 1], type: 'node' }]
        ),
        __tmpl_li_class_item_35 = K.DOM.template(
            '\n' +
            '                <li class="item ">\n' +
            '                    <input />\n' +
            '                    <button type="button"><i class="icon-remove-circle"></i></button>\n' +
            '                    \n' +
            '                </li>',
            [{ path: [1, 4], split: ['\n                    ', '\n                '] }],
            [{ path: [1], type: 'attr', name: 'class' }]
        );
    __tmpl_ul_34([
        function () { return items.map(function (item) {
            return __tmpl_li_class_item_35([
                function () { return item.classes; },
                function () { return item.name; },
                function () { return item.remove; }
            ]);
        }
    ]);

    "use strict";
    var __tmpl_ul_34 = K.DOM.template(
            '\n' +
            '        <ul>\n' +
            '        </ul>\n' +
            '    ',
            [{ path: [1, 0], splits: ['\n        ', '\n        '] }],
            [{ path: [1, 1], type: 'node' }]
        ),
        __tmpl_li_class_item_35 = K.DOM.template(
            '\n' +
            '                <li class="item ">\n' +
            '                    <input />\n' +
            '                    <button type="button"><i class="icon-remove-circle"></i></button>\n' +
            '                    \n' +
            '                </li>',
            [{ path: [1, 4], split: ['\n                    ', '\n                '] }],
            [{ path: [1], type: 'attr', name: 'class' }]
        );
    __tmpl_ul_34([
        () => items.map((item) =>
            __tmpl_li_class_item_35([
                () => item.classes,
                () => item.name,
                () => item.remove
            ]);
    ]);

    </script>

    <button type="button" onclick="{{addItem}}"><i class="icon-add-circle"></i> Add Item</button>

    <script type="text/javascript">
        var form = document.getElementById('form'),
            text = document.getElementById('text'),
            radio = document.getElementById('radio'),
            radio2 = document.getElementById('radio2'),
            checkbox = document.getElementById('checkbox'),
            textarea = document.getElementById('textarea'),
            select = document.getElementById('select'),
            multiselect = document.getElementById('multiselect'),
            submit = document.getElementById('button'),
            tmpl = document.getElementById('foo').innerText,
            tmpl64k = tmpl;

            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 4
            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 16
            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 64
            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 256
            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 1024
            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 4k
            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 16k
            tmpl64k = tmpl64k + tmpl64k + tmpl64k + tmpl64k; // 64k
    </script>
</body>
</html>
